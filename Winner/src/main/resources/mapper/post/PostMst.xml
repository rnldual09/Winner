<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.Winner.mapper.PostMapper">
	
	<select id="selPostList" resultType="CustomMap" parameterType="Map">
		SELECT p.POST_SEQ, p.USR_ID, p.OPEN_YN, p.POST_TIT, p.POST_CONT, p.POST_AREA1, p.POST_AREA2
			, p.HASH_TAG, p.PER_YN, p.TEAM_YN, p.TEAM_MIN_CNT, p.TEAM_MAX_CNT
			, DATE_FORMAT(STR_TO_DATE(p.END_DT,'%Y%m%d'),'%Y.%m.%d') END_DT, p.END_YN
			, (SELECT CASE COUNT(*) WHEN 0 THEN 'N' ELSE 'Y' END FROM POSTGOOD s WHERE s.USR_ID = #{sessionId}) GOOD_YN
			, m.PROFILE
		FROM POSTMST p
			LEFT OUTER JOIN USRMST m
				ON(p.USR_ID = m.USR_ID)
		WHERE p.END_YN = 'N'
	</select>
	
	<select id="selPostImgList" resultType="CustomMap" parameterType="int">
		SELECT POST_SEQ, IMG_SEQ, ORI_FILE, SVR_FILE
		FROM POSTIMG
		WHERE POST_SEQ = #{postSeq}
	</select>
	
	<select id="postGoodCnt" resultType="int" parameterType="int">
		SELECT COUNT(*)
		FROM POSTGOOD
		WHERE POST_SEQ = #{postSeq}
	</select>
	
</mapper>